import{_ as h,r as v}from"./index-C9ou7GSc.js";import{f as c,o as i,c as a,a as o,m as w,k as l,n as f,q as d,t as n,b as m,v as b,p as D,g as u,d as y,w as _}from"./vue-vendor-BrtzZnCP.js";import"./utils-BcjtJagn.js";const x={name:"Register",data(){return{formData:{name:"",email:"",password:"",confirmPassword:"",job:""},errors:{},errorMessage:"",loading:!1}},mounted(){this.getCurrentUser()&&this.$router.push("/")},methods:{getCurrentUser(){const e=localStorage.getItem("currentUser");return e?JSON.parse(e):null},validateForm(){this.errors={};let e=!0;this.formData.name.trim()?this.formData.name.trim().length<2&&(this.errors.name="姓名至少2个字符",e=!1):(this.errors.name="请输入姓名",e=!1);const r=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;return this.formData.email.trim()?r.test(this.formData.email)||(this.errors.email="请输入有效的邮箱地址",e=!1):(this.errors.email="请输入邮箱",e=!1),this.formData.password?this.formData.password.length<6&&(this.errors.password="密码至少6个字符",e=!1):(this.errors.password="请输入密码",e=!1),this.formData.confirmPassword?this.formData.password!==this.formData.confirmPassword&&(this.errors.confirmPassword="两次输入的密码不一致",e=!1):(this.errors.confirmPassword="请确认密码",e=!1),e},async handleRegister(){if(this.errorMessage="",this.errors={},!!this.validateForm()){this.loading=!0;try{const e=v(this.formData.name.trim(),this.formData.email.trim(),this.formData.password,this.formData.job||void 0);e.success?this.$router.push("/"):(this.errorMessage=e.message||"注册失败，请稍后重试",e.errors&&e.errors.forEach(r=>{r.includes("邮箱")&&(this.errors.email=r)}))}catch(e){this.errorMessage="注册时发生错误，请稍后重试",console.error("Register error:",e)}finally{this.loading=!1}}}}},P={class:"register-page"},k={class:"register-container"},V={class:"form-group"},U={key:0,class:"error-text"},M={class:"form-group"},R={key:0,class:"error-text"},S={class:"form-group"},j={key:0,class:"error-text"},C={class:"form-group"},N={key:0,class:"error-text"},q={class:"form-group"},B={key:0,class:"error-message"},E=["disabled"],F={class:"form-footer"};function I(e,r,T,z,s,p){const g=c("router-link");return i(),a("div",P,[o("div",k,[r[14]||(r[14]=o("h2",null,"用户注册",-1)),o("form",{class:"register-form",onSubmit:r[5]||(r[5]=w((...t)=>p.handleRegister&&p.handleRegister(...t),["prevent"]))},[o("div",V,[r[6]||(r[6]=o("label",{for:"name"},"姓名：",-1)),l(o("input",{id:"name","onUpdate:modelValue":r[0]||(r[0]=t=>s.formData.name=t),type:"text",placeholder:"请输入姓名",required:"",class:d(["form-input",{"input-error":s.errors.name}])},null,2),[[f,s.formData.name]]),s.errors.name?(i(),a("span",U,n(s.errors.name),1)):m("",!0)]),o("div",M,[r[7]||(r[7]=o("label",{for:"email"},"邮箱：",-1)),l(o("input",{id:"email","onUpdate:modelValue":r[1]||(r[1]=t=>s.formData.email=t),type:"email",placeholder:"请输入邮箱",required:"",class:d(["form-input",{"input-error":s.errors.email}])},null,2),[[f,s.formData.email]]),s.errors.email?(i(),a("span",R,n(s.errors.email),1)):m("",!0)]),o("div",S,[r[8]||(r[8]=o("label",{for:"password"},"密码：",-1)),l(o("input",{id:"password","onUpdate:modelValue":r[2]||(r[2]=t=>s.formData.password=t),type:"password",placeholder:"请输入密码（至少6位）",required:"",minlength:"6",class:d(["form-input",{"input-error":s.errors.password}])},null,2),[[f,s.formData.password]]),s.errors.password?(i(),a("span",j,n(s.errors.password),1)):m("",!0)]),o("div",C,[r[9]||(r[9]=o("label",{for:"confirmPassword"},"确认密码：",-1)),l(o("input",{id:"confirmPassword","onUpdate:modelValue":r[3]||(r[3]=t=>s.formData.confirmPassword=t),type:"password",placeholder:"请再次输入密码",required:"",class:d(["form-input",{"input-error":s.errors.confirmPassword}])},null,2),[[f,s.formData.confirmPassword]]),s.errors.confirmPassword?(i(),a("span",N,n(s.errors.confirmPassword),1)):m("",!0)]),o("div",q,[r[11]||(r[11]=o("label",{for:"job"},"岗位（可选）：",-1)),l(o("select",{id:"job","onUpdate:modelValue":r[4]||(r[4]=t=>s.formData.job=t),class:"form-input"},[...r[10]||(r[10]=[D('<option value="" data-v-ae4169fb>请选择岗位</option><option value="开发" data-v-ae4169fb>开发</option><option value="设计" data-v-ae4169fb>设计</option><option value="产品" data-v-ae4169fb>产品</option><option value="运营" data-v-ae4169fb>运营</option><option value="行政" data-v-ae4169fb>行政</option><option value="测试" data-v-ae4169fb>测试</option><option value="其他" data-v-ae4169fb>其他</option>',8)])],512),[[b,s.formData.job]])]),s.errorMessage?(i(),a("div",B,n(s.errorMessage),1)):m("",!0),o("button",{type:"submit",class:"btn btn-primary",disabled:s.loading},n(s.loading?"注册中...":"注册"),9,E),o("div",F,[o("p",null,[r[13]||(r[13]=u(" 已有账号？ ",-1)),y(g,{to:"/login",class:"link"},{default:_(()=>[...r[12]||(r[12]=[u("立即登录",-1)])]),_:1})])])],32)])])}const G=h(x,[["render",I],["__scopeId","data-v-ae4169fb"]]);export{G as default};

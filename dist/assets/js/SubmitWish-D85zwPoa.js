import{h as a}from"./wishService-BU8yXoRe.js";import{_ as h,g as n}from"./index-Ca8b0D0Z.js";import{r as S,o as u,c as m,a as s,j as l,m as d,v as j,n as w,l as k,b as f,w as p,f as c,e as v}from"./vue-vendor-CyCdHuvd.js";import"./utils-BSVtTUhg.js";const x={name:"SubmitWish",data(){return{form:{title:"",description:"",job:"",submitter:""},submitSuccess:!1,draftSuccess:!1}},mounted(){const o=n();o&&(this.form.submitter=o.name)},methods:{submitWish(){const o=n();a({title:this.form.title,description:this.form.description,job:this.form.job,submitter:this.form.submitter||void 0,submitterId:o?o.id:null,status:"published"})&&(this.submitSuccess=!0,this.resetForm(),setTimeout(()=>{this.submitSuccess=!1},5e3))},saveAsDraft(){if(!this.form.title||!this.form.description||!this.form.job){alert("请至少填写愿望名称、需求描述和岗位信息才能保存为草稿");return}const o=n();a({title:this.form.title,description:this.form.description,job:this.form.job,submitter:this.form.submitter||void 0,submitterId:o?o.id:null,status:"draft"})&&(this.draftSuccess=!0,this.resetForm(),setTimeout(()=>{this.draftSuccess=!1},5e3))},resetForm(){const o=n();this.form={title:"",description:"",job:"",submitter:o?o.name:""}}}},W={class:"submit-wish"},y={class:"form-group"},V={class:"form-group"},g={class:"form-group"},C={class:"form-group"},F={class:"form-actions"},N={key:0,class:"success-message"},U={key:1,class:"success-message"};function D(o,t,T,q,i,r){const b=S("router-link");return u(),m("div",W,[t[17]||(t[17]=s("h2",null,"提交新愿望",-1)),s("form",{class:"wish-form",onSubmit:t[6]||(t[6]=k((...e)=>r.submitWish&&r.submitWish(...e),["prevent"]))},[s("div",y,[t[7]||(t[7]=s("label",{for:"title"},"愿望名称 *",-1)),l(s("input",{id:"title","onUpdate:modelValue":t[0]||(t[0]=e=>i.form.title=e),type:"text",required:"",placeholder:"请输入愿望名称",class:"form-input"},null,512),[[d,i.form.title]])]),s("div",V,[t[8]||(t[8]=s("label",{for:"description"},"需求描述 *",-1)),l(s("textarea",{id:"description","onUpdate:modelValue":t[1]||(t[1]=e=>i.form.description=e),required:"",placeholder:"请详细描述您的需求",rows:"6",class:"form-textarea"},null,512),[[d,i.form.description]])]),s("div",g,[t[10]||(t[10]=s("label",{for:"job"},"提交者岗位 *",-1)),l(s("select",{id:"job","onUpdate:modelValue":t[2]||(t[2]=e=>i.form.job=e),required:"",class:"form-select"},[...t[9]||(t[9]=[w('<option value="" data-v-b7bbc8dc>请选择岗位</option><option value="开发" data-v-b7bbc8dc>开发</option><option value="设计" data-v-b7bbc8dc>设计</option><option value="行政" data-v-b7bbc8dc>行政</option><option value="产品" data-v-b7bbc8dc>产品</option><option value="运营" data-v-b7bbc8dc>运营</option><option value="其他" data-v-b7bbc8dc>其他</option>',7)])],512),[[j,i.form.job]])]),s("div",C,[t[11]||(t[11]=s("label",{for:"submitter"},"提交者姓名",-1)),l(s("input",{id:"submitter","onUpdate:modelValue":t[3]||(t[3]=e=>i.form.submitter=e),type:"text",placeholder:"可选，默认为匿名用户",class:"form-input"},null,512),[[d,i.form.submitter]])]),s("div",F,[t[12]||(t[12]=s("button",{type:"submit",class:"btn btn-primary"},"提交愿望",-1)),s("button",{type:"button",class:"btn btn-draft",onClick:t[4]||(t[4]=(...e)=>r.saveAsDraft&&r.saveAsDraft(...e))},"保存为草稿"),s("button",{type:"button",class:"btn btn-secondary",onClick:t[5]||(t[5]=(...e)=>r.resetForm&&r.resetForm(...e))},"重置")])],32),i.submitSuccess?(u(),m("div",N,[t[14]||(t[14]=s("p",null,"✅ 愿望提交成功！",-1)),f(b,{to:"/",class:"link"},{default:p(()=>[...t[13]||(t[13]=[c("返回首页查看",-1)])]),_:1})])):v("",!0),i.draftSuccess?(u(),m("div",U,[t[16]||(t[16]=s("p",null,"✅ 愿望已保存为草稿！您可以在管理面板中编辑和发布。",-1)),f(b,{to:"/admin",class:"link"},{default:p(()=>[...t[15]||(t[15]=[c("前往管理面板",-1)])]),_:1})])):v("",!0)])}const E=h(x,[["render",D],["__scopeId","data-v-b7bbc8dc"]]);export{E as default};
